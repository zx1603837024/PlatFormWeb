@using P4.Web.Models
@model  SystemParamSetting
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = L("SystemParamSetting");
    ViewBag.ActiveMenu = "SystemParamSetting";
}
<form class="form-horizontal" role="form">
    <div class="form-group">
            <label class="control-label col-xs-12 col-sm-3">状态设置</label>

            <div class="controls col-xs-12 col-sm-9">
                <div class="row">
                    <div class="col-xs-3">

                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="ParkApprove" @(Model.ParkApprove == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;启用停车场审批</span>
                        </label>
                    </div>
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="TaskScheduling" @(Model.TaskScheduling == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;排班任务自动化</span>
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3">

                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="OperationLog" @(Model.OperationLog == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;记录操作日志</span>
                        </label>
                    </div>
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="DataLog" @(Model.DataLog == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;记录操作数据</span>
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3">

                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="WhiteListOperation" @(Model.WhiteListOperation == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;白名单操作审批</span>
                        </label>
                    </div>
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="SystemMailbox" @(Model.SystemMailbox == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;启用邮箱通道</span>
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3">

                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="AuditLog" @(Model.AuditLog == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;记录审计日志</span>
                        </label>
                    </div>
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="SMSChannel" @(Model.SMSChannel == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;启用短信通道</span>
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="MapLocation" @(Model.MapLocation == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;地图位置定位</span>
                        </label>
                    </div>

                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="EscapeLock" @(Model.EscapeLock == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;启用追缴锁定</span>
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="TheRecoveredCompany" @(Model.TheRecoveredCompany == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;全公司追缴金额</span>
                        </label>
                    </div>
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="TheRecovered" @(Model.TheRecovered == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;全国追缴金额</span>
                        </label>
                    </div>
                </div>
                <div class="space-4"></div>
                <div class="row">
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="EscapeBlack" @(Model.EscapeBlack == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;启用欠费黑名单</span>
                        </label>
                    </div>
                    <div class="col-xs-3">
                        <label>

                            <input type="text" id="EscapeBlackMoney" value=@Model.EscapeBlackMoney class="with-40" placeholder="欠费金额" />
                        </label>
                    </div>
                </div>
                <div class="space-4"></div>
                <div class="row">
                    <div class="col-xs-3">
                        <label>
                            <input name="switch-field-1" class="ace ace-switch ace-switch-3" type="checkbox" id="EscapePhoto" @(Model.EscapePhoto == true ? "checked='checked'" : "") />
                            <span class="lbl">&nbsp;&nbsp;启用欠费拍照</span>
                        </label>
                    </div>
                    <div class="col-xs-3">
                        <label>
                            <input type="text" id="EscapePhotoMoney" value=@Model.EscapePhotoMoney class="with-40" placeholder="欠费金额" />
                        </label>
                    </div>
                </div>
                <div class="space-4"></div>
                <div class="row">
                    <div class="col-xs-3">
                        <label>                          
                            <text>启用系统邮箱(多个以;分割)</text>
                        </label>
                    </div>
                    <div class="col-xs-3">
                        <label>
                            <input type="text" id="EmailAdress" value=@Model.EmailAdress class="with-40" placeholder="邮箱地址" />
                        </label>
                    </div>
                </div>


    <div class="space-4"></div>
    <div class="row">
        <div class="col-xs-3">
            <label>
                <text>收费员达标指标</text>
            </label>
        </div>
        <div class="col-xs-3">
            <label>
                <input type="text" id="TargetAmount" value=@Model.TargetAmount class="with-40" placeholder="达标金额" />
            </label>
        </div>
    </div>
    </div>
   </div>

    <div class="clearfix form-actions">
        <div class="col-md-offset-3 col-md-9">
            <button class="btn btn-info" type="button" onclick="javascript:Save()">
                <i class="icon-ok bigger-110"></i>
                保存
            </button>

            &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;
            &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;
            <button class="btn" type="reset">
                <i class="icon-undo bigger-110"></i>
                重置
            </button>
        </div>
    </div>
</form>
@section scripts{
    <script type="text/javascript">
			jQuery(function($) {
				$('#id-disable-check').on('click', function() {
					var inp = $('#form-input-readonly').get(0);
					if(inp.hasAttribute('disabled')) {
						inp.setAttribute('readonly' , 'true');
						inp.removeAttribute('disabled');
						inp.value="This text field is readonly!";
					}
					else {
						inp.setAttribute('disabled' , 'disabled');
						inp.removeAttribute('readonly');
						inp.value="This text field is disabled!";
					}
				});


				//$(".chosen-select").chosen();
				$('#chosen-multiple-style').on('click', function(e){
					var target = $(e.target).find('input[type=radio]');
					var which = parseInt(target.val());
					if(which == 2) $('#form-field-select-4').addClass('tag-input-style');
					 else $('#form-field-select-4').removeClass('tag-input-style');
				});


				$('[data-rel=tooltip]').tooltip({container:'body'});
				$('[data-rel=popover]').popover({container:'body'});


				

				$('#id-input-file-3').ace_file_input({
					style:'well',
					btn_choose:'Drop files here or click to choose',
					btn_change:null,
					no_icon:'icon-cloud-upload',
					droppable:true,
					thumbnail:'small'//large | fit
					//,icon_remove:null//set null, to hide remove/reset button
					/**,before_change:function(files, dropped) {
						//Check an example below
						//or examples/file-upload.html
						return true;
					}*/
					/**,before_remove : function() {
						return true;
					}*/
					,
					preview_error : function(filename, error_code) {
						//name of the file that failed
						//error_code values
						//1 = 'FILE_LOAD_FAILED',
						//2 = 'IMAGE_LOAD_FAILED',
						//3 = 'THUMBNAIL_FAILED'
						//alert(error_code);
					}

				}).on('change', function () {
				    alert('111');
				    var thumb = $('#id-input-file-3').next().find('img').data('thumb');
				    alert(thumb);
				});


				//dynamically change allowed formats by changing before_change callback function
				$('#id-file-format').removeAttr('checked').on('change', function() {
					var before_change
					var btn_choose
					var no_icon
					if(this.checked) {
						btn_choose = "Drop images here or click to choose";
						no_icon = "icon-picture";
						before_change = function(files, dropped) {
							var allowed_files = [];
							for(var i = 0 ; i < files.length; i++) {
								var file = files[i];
								if(typeof file === "string") {
									//IE8 and browsers that don't support File Object
									if(! (/\.(jpe?g|png|gif|bmp)$/i).test(file) ) return false;
								}
								else {
									var type = $.trim(file.type);
									if( ( type.length > 0 && ! (/^image\/(jpe?g|png|gif|bmp)$/i).test(type) )
											|| ( type.length == 0 && ! (/\.(jpe?g|png|gif|bmp)$/i).test(file.name) )//for android's default browser which gives an empty string for file.type
										) continue;//not an image so don't keep this file
								}

								allowed_files.push(file);
							}
							if(allowed_files.length == 0) return false;

							return allowed_files;
						}
					}
					else {
						btn_choose = "Drop files here or click to choose";
						no_icon = "icon-cloud-upload";
						before_change = function(files, dropped) {
							return files;
						}
					}
					var file_input = $('#id-input-file-3');
					file_input.ace_file_input('update_settings', {'before_change':before_change, 'btn_choose': btn_choose, 'no_icon':no_icon})
					file_input.ace_file_input('reset_input');
				});




				$('#spinner1').ace_spinner({value:0,min:0,max:200,step:10, btn_up_class:'btn-info' , btn_down_class:'btn-info'})
				.on('change', function(){
					//alert(this.value)
				});
				$('#spinner2').ace_spinner({value:0,min:0,max:10000,step:100, touch_spinner: true, icon_up:'icon-caret-up', icon_down:'icon-caret-down'});
				$('#spinner3').ace_spinner({value:0,min:-100,max:100,step:10, on_sides: true, icon_up:'icon-plus smaller-75', icon_down:'icon-minus smaller-75', btn_up_class:'btn-success' , btn_down_class:'btn-danger'});

				/////////
				$('#modal-form input[type=file]').ace_file_input({
					style:'well',
					btn_choose:'Drop files here or click to choose',
					btn_change:null,
					no_icon:'icon-cloud-upload',
					droppable:true,
					thumbnail:'large'
				})

				//chosen plugin inside a modal will have a zero width because the select element is originally hidden
				//and its width cannot be determined.
				//so we set the width after modal is show
				$('#modal-form').on('shown.bs.modal', function () {
					$(this).find('.chosen-container').each(function(){
						$(this).find('a:first-child').css('width' , '210px');
						$(this).find('.chosen-drop').css('width' , '210px');
						$(this).find('.chosen-search input').css('width' , '200px');
					});
				})
				/**
				//or you can activate the chosen plugin after modal is shown
				//this way select element becomes visible with dimensions and chosen works as expected
				$('#modal-form').on('shown', function () {
					$(this).find('.modal-chosen').chosen();
				})
				*/


			});

			function Save() {
			    swal({
			        title: "系统提示?",
			        text: "您确定要保存吗？",
			        type: "warning",
			        showCancelButton: true,
			        confirmButtonColor: "#DD6B55",
			        confirmButtonText: "确定,保存!",
			        closeOnConfirm: false
			     },
                 function () {

                     //alert($("#ParkApprove").attr("checked"));
                 

                    
                     swal("成功!", "正在保存.", "success");
                     $.ajax({
                         type: "Post",
                         url: '../SystemParamSetting/SetSystemParamSetting',
                         data: {
                             ParkApprove: $('#ParkApprove').is(':checked'),
                             TaskScheduling: $('#TaskScheduling').is(':checked'),
                             OperationLog: $('#OperationLog').is(':checked'),
                             AuditLog: $('#AuditLog').is(':checked'),
                             DataLog: $('#DataLog').is(':checked'),
                             WhiteListOperation: $('#WhiteListOperation').is(':checked'),
                             SystemMailbox: $('#SystemMailbox').is(':checked'),
                             SMSChannel: $('#SMSChannel').is(':checked'),
                             MapLocation: $('#MapLocation').is(':checked'),
                             TheRecovered: $('#TheRecovered').is(':checked'),//EscapeLock
                             TheRecoveredCompany: $('#TheRecoveredCompany').is(':checked'),
                             EscapeLock: $('#EscapeLock').is(':checked'),
                             EscapeBlack: $('#EscapeBlack').is(':checked'),
                             EscapeBlackMoney: $('#EscapeBlackMoney').val(),
                             EscapePhoto: $('#EscapePhoto').is(':checked'),
                             EscapePhotoMoney: $('#EscapePhotoMoney').val(),
                             EmailAdress: $('#EmailAdress').val(),
                             TargetAmount: $('#TargetAmount').val()
                         },
                         success: function (data) {

                             //window.location.href = "../Platform/Login";
                         }, error: function () {

                         }
                     });
                 });
			}
    </script>
}





